# hybrid App与前端混合开发

## 文字解释
* hybrid即混合，前端和客户端混合配合开发
* 某些环节也可能涉及到server端

## 存在价值
* 快速迭代更新【关键】（无需app审核，JS代码无系统级权限）
* 体验流畅（和NA原生体验基本无差）
* 减少开发和沟通成本，双端公用一套代码

## webview
* 是app中的一个组件（app可有webview可无）
* 用于加载h5页面，即小型的浏览器内核

## file协议与http(s)协议
* file协议：本地文件，快
* http(s)协议：网络加载，慢
* hybrid使用file协议，实现NA体验

## 应用场景
* 使用NA：体验要求极致，变化不频繁（如首页）
* 使用hybrid：体验要求高，变化频繁（如内容详情页）
* 使用h5: 体验较低，不常用（如反馈页面）

## 实现流程
* 前端做好静态页面，交给客户端
* 客户端将前端静态页面以文件形式存储在app中
* 客户端在一个webview中使用file协议加载静态页面

## 疑问
* app发布后，如何实时更新静态文件
    * 目的要替换客户端的静态文件
    * 只能由客户端完成
    * 客户端从server下载最新的静态文件（利用版本号先检查是否有更新）
* 静态文件如何获取内容
    * 不能用JS ajax获取，1 跨域；2 速度慢
    * 客户端（预）获取，通讯给JS渲染内容

## hybrid与H5

### hybrid优缺点
* 优点
    * 可快速迭代，无需app审核【关键】
    * 体验更好，跟NA基本一致
* 缺点
    * 开发成本高。联调、测试、排查都更麻烦
    * 运维成本高。更新上线流程更麻烦

### 适用场景
* hybrid：产品型。适用于产品的稳定功能中，体验要求高，迭代频繁
* H5：运营型。单次的运营活动或不常用功能

# 前端和客户端通讯

## 通讯基本形式
* 前端JS携带参数与callback传递给客户端
* 客户端接受参数且执行完成后执行callback

## schema 协议
* schema 协议是前端和客户端通讯间的约定
* 通过iframe使用
* 类似协定的file协议、http协议

## 内置上线
* 前端JS代码封装打包，内置到客户端
* 客户端每次启动webview，默认执行打包代码
* 本地加载，免去网络加载时间，速度更快
* 本地加载，无网络请求，看不到schema协议，更安全